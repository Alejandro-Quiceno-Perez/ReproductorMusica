import{r as o,j as e}from"./index-BEtzwjzl.js";import{D as d,t as k}from"./timer-CsqZAgT7.js";let h,T;const L=(c,a,g)=>{if(!h){const u=window.AudioContext||window.webkitAudioContext,m=new u;let r=m.createMediaElementSource(c);h=m.createAnalyser(),r.connect(h),r.connect(m.destination)}h.fftSize=64;let x=h.frequencyBinCount,j=new Uint8Array(x);if(!a||!a.getContext){console.error("El canvas no est√° definido o no tiene contexto.");return}const s=a.getContext("2d"),p=a.width=a.clientWidth,l=a.height=a.clientHeight;function f(){T=requestAnimationFrame(f),h.getByteTimeDomainData(j),s.beginPath(),s.clearRect(0,0,p,l);for(let u=0;u<x;u++){let m=j[u]/10;s.arc(p/2,l/2,Math.abs(100+m),0,2*Math.PI),s.shadowColor="blue",s.shadowBlur=1,s.strokeStyle="red",s.stroke()}}g?cancelAnimationFrame(T):f()},B=({props:{musicNumber:c,setMusicNumber:a,setOpen:g}})=>{const[x,j]=o.useState(1),[s,p]=o.useState(0),[l,f]=o.useState(!1),[u,m]=o.useState(!1),[r,y]=o.useState(50),[N,_]=o.useState("repeat"),i=o.useRef(),w=o.useRef(),A=t=>{const n=t.nativeEvent.srcElement.src,C=new Audio(n);C.onloadedmetadata=()=>{C.readyState>0&&j(C.duration)},l&&i.current.play()},E=()=>{L(i.current,w.current,l),l?(i.current.pause(),f(!1)):(i.current.play(),f(!0))},R=t=>{const n=i.current.currentTime;p(n)},D=t=>{const n=Number(t.target.value);i.current.currentTime=n,p(n)},v=t=>{a(n=>t>0?n+t>d.length-1?0:n+t:n+t<0?d.length-1:n+t)},P=()=>{_(t=>{switch(t){case"repeat":return"repeat_one";case"repeat_one":return"shuffle";default:return"repeat"}})},q=()=>{switch(N){case"repeat_one":return i.current.play();case"shuffle":return H();default:return v(1)}},H=()=>{const t=S();a(t)},S=()=>{const t=Math.floor(Math.random()*(d.length-1));return t===c?S():t};return o.useEffect(()=>{i.current.volume=r/100},[r]),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"nav",children:[e.jsx("i",{className:"material-icons",children:"expand_more"}),e.jsxs("span",{children:["La Oveja Negra ",c+1,"/",d.length," "]}),e.jsx("i",{className:"material-icons",onClick:()=>g(t=>!t),children:"queue_music"})]}),e.jsxs("div",{className:"img",children:[e.jsx("img",{src:d[c].img,alt:"",className:`${l?"playing":""}`}),e.jsx("canvas",{ref:w})]}),e.jsxs("div",{className:"details",children:[e.jsx("p",{className:"title",children:d[c].title}),e.jsx("p",{className:"artist",children:d[c].artist})]}),e.jsx("div",{className:"progress",children:e.jsx("input",{type:"range",min:0,max:x,value:s,onChange:t=>D(t)})}),e.jsxs("div",{className:"timer",children:[e.jsx("span",{children:k(s)}),e.jsx("span",{children:k(x)})]}),e.jsxs("div",{className:"controls",children:[e.jsx("i",{className:"material-icons",onClick:P,children:N}),e.jsx("i",{className:"material-icons",id:"prev",onClick:()=>v(-1),children:"skip_previous"}),e.jsx("div",{className:"play",onClick:E,children:e.jsx("i",{className:"material-icons",children:l?"pause":"play_arrow"})}),e.jsx("i",{className:"material-icons",id:"next",onClick:()=>v(1),children:"skip_next"}),e.jsx("i",{className:"material-icons",onClick:()=>m(t=>!t),children:r===0?"volume_off":"volume_up"}),e.jsxs("div",{className:`volume ${u?"show":""}`,children:[e.jsx("i",{className:"material-icons",onClick:()=>y(t=>t>0?0:100),children:r===0?"volume_off":"volume_up"}),e.jsx("input",{type:"range",min:0,max:100,value:r,onChange:t=>y(Number(t.target.value))}),e.jsx("span",{children:r})]})]}),e.jsx("audio",{src:d[c].song,hidden:!0,ref:i,onLoadStart:A,onTimeUpdate:R,onEnded:q})]})};export{B as default};
